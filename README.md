# 📚 Book Browser Dashboard (Supabase + Streamlit + Modal)

---

Developed by Tommie Clark, this project demonstrates an end-to-end pipeline: scraping book data, generating AI summaries, storing results in **Supabase**, and exploring them in a **Streamlit** dashboard—run locally or deployed to **Modal** for a persistent, serverless web app.

🌐 Live Demo: [Book Browser](https://clarktommie--book-browser-run.modal.run)


---

## ✨ Features

- Scrape book details from "Books to Scrape" a mock dataset (title, price, availability, rating)
- Generate concise AI summaries per book
- Store and query data in **Supabase** (`books` table)
- Visualize in **Streamlit**:
  - Filter by title
  - Ratings shown as ⭐ (1–5)
  - Charts for rating distribution, price distribution, availability breakdown
  - Expandable AI summaries
  - Raw data table
- Deploy as a public web app via **Modal**

---

## 🧱 Architecture

1. **Scrape & Summarize** (run separately): collect books, call an LLM to summarize, write CSV, upsert rows into Supabase.
2. **Store**: Supabase (Postgres + REST) holds the normalized data.
3. **Visualize**: Streamlit app reads from Supabase and renders filters, charts, and summaries.
4. **Deploy**: Modal container runs the Streamlit app and exposes a public URL.

---

## 🛠 Tech Stack

- Python 3.12
- Libraries: streamlit, supabase, pandas, plotly, python-dotenv, pydeck, folium, streamlit-folium
- Backend: Supabase (Postgres + PostgREST)
- Deployment: Modal (serverless containers)

---

## 📦 Project Structure

    ## 📦 Project Structure

    project-root/
    ├─ llmPractice.py            # Scraper + AI summaries + Supabase insert (run first to populate)
    ├─ streamlit_app.py          # Streamlit dashboard
    ├─ streamlit_modal.py        # Modal deployment wrapper
    ├─ books_with_summaries.csv  # Optional CSV backup from the scrape
    ├─ pyproject.toml            # Dependencies and project metadata
    ├─ .gitignore                # Ignore secrets and virtual env
    ├─ .env                      # Local Supabase credentials (not committed)
    └─ README.md                 # Project documentation

---

## ⚙️ Setup

1. Create and activate a virtual environment

   uv venv .venv
   source .venv/bin/activate

2. Install dependencies

   uv pip install streamlit supabase pandas plotly python-dotenv pydeck folium streamlit-folium

3. Add environment variables (create a `.env` file at repo root)

   SUPABASE_URL=https://<your-project-ref>.supabase.co
   SUPABASE_KEY=<your-anon-or-service-role-key>

4. Create the Supabase table (run in Supabase SQL editor)

   create table if not exists books (
   id bigint generated by default as identity primary key,
   title text,
   price text,
   availability text,
   rating text,
   summary text
   );
   alter table public.books
   add column updated_at timestamptz default now();

5. Populate data (optional but recommended before opening the dashboard)

   # Run your scraper to fetch books, generate summaries, and insert into Supabase

   uv run llmPractice.py

---

## ▶️ Run Locally

    streamlit run streamlit_app.py

Open the app at: http://localhost:8501

---

## ☁️ Deploy to Modal (Persistent Public URL)

1. Authenticate the Modal CLI (one time)

   modal token new

(Your browser opens → log in → token saved to ~/.modal.toml)

2. Deploy

   modal deploy streamlit_modal.py

3. Stop when done

   modal stop book-browser

Tip: For a quick, one-off session instead of a full deploy:

    modal run streamlit_modal.py::run

---

## 🧪 How to Use the Dashboard

- Use the **sidebar** to filter by book title.
- Each book shows **Price**, **Availability**, and **Rating** (⭐ 1–5).
- Expand **AI Summary** to read a concise blurb for the book.
- Explore **charts** for overall rating distribution, prices, and availability.
- Scroll to the **Raw Data Table** for sortable/searchable records.

---

## 🐛 Common Issues & Fixes (real ones we solved)

- **KeyError: 'Title' in Streamlit**  
  Postgres/Supabase commonly stores and returns lowercase keys.  
  Fix: standardize on lowercase column names (`title`, `price`, `availability`, `rating`, `summary`) before inserting, and reference lowercase keys in the app.

- **Invalid API key (Supabase)**  
  Typically due to a wrong or missing `.env` entry.  
  Fix: ensure `SUPABASE_URL` and `SUPABASE_KEY` are correct; restart terminal or re-source the environment so Streamlit inherits them.

- **Could not find the table 'public.books' (PGRST205)**  
  The table doesn’t exist yet or is misnamed.  
  Fix: run the `create table books (...)` SQL shown above; confirm the project and schema.

- **No such option: --token-id (Modal)**  
  Newer Modal CLI removed those flags.  
  Fix: run `modal token new` with no arguments; it opens your browser to create and store the token automatically.

- **Specify a Modal Function or local entrypoint to run**  
  Modal didn’t find a decorated function.  
  Fix: ensure your deployment file exposes a function decorated with `@app.function` and `@modal.web_server(8000)`, and call it with `modal run <file>::<function>` or `modal deploy <file>`.

- **Packages not found despite installing**  
  Caused by mixing base Conda env with uv virtualenv.  
  Fix: ensure you’re inside the correct venv (`source .venv/bin/activate`), or use `uv run` to execute within that env explicitly.

---

## 🔒 Security Notes

- Do not commit your `.env`.
- Prefer Modal **Secrets** for production deployments (e.g., a secret bundle containing `SUPABASE_URL`, `SUPABASE_KEY`).
- Treat service roles as sensitive credentials; use the anon key when possible for read-only dashboards.

---

## 🙌 Author

**Tommie Clark** — building practical, end-to-end data projects with web scraping, Supabase, Streamlit, and cloud deployment.

## 📫 Contact

I’d love to connect! Feel free to reach out through any of the following:

- **Email**: [Lets Connect!](mailto:tommieclark.tlc@gmail.com)  
- **LinkedIn**: [Tommie Clark](https://www.linkedin.com/in/tommie-clark-71249982/)  
- **GitHub**: [Clarktommie](https://github.com/clarktommie)  


---

